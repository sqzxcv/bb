(function(){var n="0.1.37",e,a="undefined",t=25,r=parseInt(1e3/t),o=e,i={"function":!0,object:!0},s={DEBUG_MODE:!1,counterID:"1",instanceID:"externalConf###Instanceid"},u=function(n){return typeof n!==a},c="HISTATS_CANVAS_DEBUG_ON";s.DEBUG_MODE=u(window[c])&&1==window[c];var l=function(){return s.instanceID},f="_HistatsCounterGraphics_",d,v=function(){return f+s.counterID},h=function(n){return!("string"!=typeof n||""==n)},g=function(){try{s.DEBUG_MODE&&u(console)&&console.log.apply(this,arguments)}catch(n){}},p=function(a,t){var i=a||{};try{var c=function(n){var e="autostart";return"undefined"!=typeof n[e]&&n[e]===!0},l={ANIMATION_RUNNING_STATUS:!0,ANIMATION_STARTED:!1,AUTOSTART:c(i),_STOPPED:!1,INSTANCE_ID:"-"+parseInt(1e4*Math.random())},f=function(){return l.INSTANCE_ID},h=100,p=1,w=function(){return t.document},b=function(n){return u(n)&&!!w().getElementById(n)},A=function(n){o=t.setTimeout(n,r)},m=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||A,T=t["Date"]||{},C=function(n,e){for(var a in n)e.hasOwnProperty(a)&&(e[a]=n[a])};i.getInstanceID=f;var y=v();i.IS_HISTATS_CANVAS=!0,i.globalObjectName=y,i.$window=t;var I=function(n){return b(n)?w().getElementById(n):e},x={w:0,h:0,yBase:0,xBase:0,hasShadow:!1,hasLabel:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:1,doMouseOverOut:1},B={msLastFrameDrawn:0,msPerFrame:r,frameCounter:0,isInAnimationTransition:!1,animation_duration_inFrames:20,waitframesBetweenTwoAnimations:80,framesBetweenTwoAnimations:100,currentLoopFrame:0,autoTriggerTextChange_onFrame:e,customization:{}},S={domCanvasObject:null,canvas2dContext:null,canvasProperties:x},_=function(){var n={},a=n.hasOwnProperty,t=0,r=0,o={blockMessages:!1,recordMessages:!1,messageLog:[],printMessages:!1,messagePassedCount:0,subscribersCount:0,topicsCount:0,_topics:n},i=function(e){return a.call(n,e)},s=function(e){return o.printMessages&&console.log(f(),"addTopic",e),r++,o.topicsCount++,r>50&&g(f(),"Lot of topics registered!",e),n[e]=[]},u=function(e){return n[e]},c=function(e,a,r){o.printMessages&&console.log(f(),"subscribe",e,a,r),o.recordMessages&&o.messageLog.push(["subscribe",e,a,r]),r=r||h,i(e)||s(e);var c=u(e).push({callback:a,priority:a})-1;return t++,o.subscribersCount++,t>50&&g(f(),"Lot of topics registered!",e),{remove:function(){delete n[e][c]}}},l=function(n,e){var a="no-topic-found";n!=a&&d(a,{topic:n,info:e})},d=function(a,t){return o.messagePassedCount++,o.printMessages&&console.log(f(),"publish",a,t),o.recordMessages&&o.messageLog.push(["publish",a,t]),o.blockMessages?void 0:i(a)?(n[a].slice().sort(function(n,e){return n.priority-e.priority}).forEach(function(n){n.callback(t!=e?t:{})}),void 0):(l(a,t),void 0)},v=function(n,e){m(function(){d(n,e)})};return{subscribe:c,publish:d,publishAsync:v,debugObj:o}}(),N=function(){return s.counterID},O=function(){var n="siteId";return i[n]=i[n]||0},L=function(){var n="main_div_name";return i[n]||"histats_counter_"+O()+"_"+N()},M=[],P=function(){return d=L(),d},k=function(){return P()+"_canvas"},E=function(){return"http://www.histats.com/viewstats/?sid="+O()+"&ccid="+N()},U=function(){t.location=E()},F=function(){if(1==S.canvasProperties.doMouseOverOut){var n=W().canvasProperties;n.yBase=2,n.xBase=2,n.shadowOffsetX=0,n.shadowOffsetY=0}W().domCanvasObject.style.cursor="pointer"},D=function(){if(1==S.canvasProperties.doMouseOverOut){var n=W().canvasProperties;n.yBase=0,n.xBase=0,n.shadowOffsetX=2,n.shadowOffsetY=2}},R=function(){var n=W(),e=n.canvasProperties,a=n.canvas2dContext;a.shadowOffsetX=e.shadowOffsetX,a.shadowOffsetY=e.shadowOffsetY,a.shadowBlur=e.shadowBlur,a.shadowColor="rgba(0,0,0,0.2)"},q=function(){return I(P())},V=function(){var n=!!q();return n},K=function(){try{if(!V())return _.publish("error",{msg:"validateDomcontainer not found"}),void 0;var n=q(),e=W().canvasProperties,a='<canvas id="'+k()+'" width="'+e.w+'" height="'+e.h+'" ></canvas>',r='<a href="'+E()+'" target="_blank">'+a+"</a>";n.innerHTML=r,W().domCanvasObject=I(k());var o=W().domCanvasObject;W().canvas2dContext=o.getContext("2d"),"addEventListener"in t?(o.addEventListener("mouseover",function(){F()}),o.addEventListener("mouseout",function(){D()})):o.onclick=function(){U()}}catch(i){g(f(),"drawCanvas",i)}},X=function(){try{if(l.ANIMATION_STARTED)return;if(l._STOPPED)return;_.publish("draw-callback-requested-reconfiguration",{}),_.publish("starting_pre",{context:i}),l.ANIMATION_STARTED=!0,_.publish("started",{context:i}),_.publish("drawcanvas_pre",{context:i}),K(),_.publish("drawcanvas_post",{context:i}),H(),_.publish("animationLoop_started",{context:i})}catch(n){g(f(),"startNow",n,n.message)}},Q=function(n,e,a){e.addEventListener?e.addEventListener(n,a,!1):e.attachEvent?e.attachEvent("on"+n,a):e[n]=a},G=function(){try{_.publish("appendedStart",{context:i,type:"animFrame"}),m(X)}catch(n){g(f(),"startAsap",n.message,n)}},Y=function(n,e){M.push({name:n,callback:e})},J=function(){},z=function(){M.forEach(function(n){n.callback(i.getCanvas2dContext(),B,W())})},j=function(){u(o)&&t.clearTimeout(o)},H=function(){l._STOPPED||m(function(){en(z),l.ANIMATION_RUNNING_STATUS&&H()})};_.subscribe("setAnimationProperties",function(n){C(n,B)}),_.subscribe("draw-callback-publish-reconfiguration",function(n){try{n.canvasCallbacks.forEach(function(n){M.push({name:n.name,callback:n.cb,priority:n.priority})}),M=M.slice().sort(function(n,e){return n.priority-e.priority})}catch(e){g(f(),"animationLoop",e.message,e)}}),_.subscribe("configuration-changed",function(n){M=[],_.publish("draw-callback-requested-reconfiguration",{})});var Z=function(n){var e=n!=l.ANIMATION_RUNNING_STATUS;return e&&(0==l.ANIMATION_RUNNING_STATUS&&1==n,1==l.ANIMATION_RUNNING_STATUS&&0==n&&j(),l.ANIMATION_RUNNING_STATUS=n),e},W=function(){return S},$=function(){var n=!1;0==B.frameCounter&&_.publish("FIRST-FRAME",{});var e=T.now(),a=e-B.msLastFrameDrawn;if(a>B.msPerFrame){var t=a%B.msPerFrame;B.msLastFrameDrawn=e-t,n=!0}return n},nn=function(){if(!(B.animation_duration_inFrames<1)){var n=B.animation_duration_inFrames+B.waitframesBetweenTwoAnimations;B.currentLoopFrame=B.frameCounter%n;var e=0==B.currentLoopFrame,a=B.currentLoopFrame>=B.animation_duration_inFrames;e&&(B.isInAnimationTransition=!0,_.publish("drawing-triggered-animation-start",B)),a&&B.isInAnimationTransition&&(B.isInAnimationTransition=!1,_.publish("drawing-triggered-animation-end",B))}},en=function(n){var e=$();e&&(B.frameCounter++,nn(),n())},an=function(n){return n(i.getCanvas2dContext())},tn=function(){var n=17,e=2,a=1,t=W().canvasProperties,r=0;t.hasShadow&&(r=r+e+a),t.hasLabel&&(t.h=t.h+n),t.w=t.w+r,t.h=t.h+r},rn=function(n){C(n,W().canvasProperties),tn()};_.subscribe("setCanvasProperties",rn,10);var on=function(){i.onCanvas2dContext(function(n){var e=W().canvasProperties;n.clearRect(0,0,e.w,e.h),e.hasShadow&&R()})};_.subscribe("clear-canvas-rectangle",on,10);var sn=function(n,e){W().hasShadow&&(n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.shadowColor="transparent")},un=function(n,a){a.autoTriggerTextChange_onFrame!==e&&a.currentLoopFrame==a.autoTriggerTextChange_onFrame&&_.publish("drawing-change-text",{})},cn=function(n){_.publish("draw-callback-publish-reconfiguration",{canvasCallbacks:[{cb:sn,priority:14,name:"stopApplyingShadowOnCanvas"},{cb:un,priority:5,name:"autoUpdateText"}]})};_.subscribe("draw-callback-requested-reconfiguration",cn,15),i.__CODE_VERSION=n,i.getCanvasObject=W,i.getCanvas2dContext=function(){return W().canvas2dContext},i.onCanvas2dContext=an,i.getXYCanvas=function(){return{x:W().canvasProperties.xBase,y:W().canvasProperties.yBase}},i.addDrawCallback=Y,i.getCanvasProperties=function(){return W().canvasProperties},i.setCanvasProperties=function(n){for(var e in n)n.hasOwnProperty(e)&&(S.canvasProperties[e]=n[e])},i.updateCanvasProperties=function(n){i.setCanvasProperties(n(W().canvasProperties))},i.getAnimationFrames=function(){return B.frameCounter},i.getAnimationControl=function(){return B},i.setAnimationControl=function(n){for(var e in n)n.hasOwnProperty(e)&&(B[e]=n[e])},i.start=G,i.changeRunningStatus=Z,i.getRunningStatus=function(){return l.ANIMATION_RUNNING_STATUS},i.eventBus=_,i.getDebugMode=function(){return s.DEBUG_MODE},function(){var n=this;n.IS_HISTATS_CANVAS||(n={});var a=n.statsText={},t={xBase:0,yBase:0},r=function(){return t},o=function(){var e=n.getXYCanvas();return t.xBase=e.x,t.yBase=e.y,t},i=[],s={stats_values:[],indexStatToShow:0,drawValueCallback:e,drawValueCallbackWithValue:e,drawMetricCallback:e},u=25,c=0,l=function(){return c%u==1},f=function(n){i=n};n.eventBus.subscribe("set-textbox-style",function(e){i=e,n.eventBus.publish("configuration-changed",{})}),n.eventBus.subscribe("canvas-drawValueFunction",function(n){"undefined"!=typeof n["transformationFunction"]&&(s.drawValueCallback=n["transformationFunction"])});function d(n,e,a,t){n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+n)?+n:0,o=isFinite(+e)?Math.abs(e):0,i="undefined"==typeof t?",":t,s="undefined"==typeof a?".":a,u="",c=function(n,e){var a=Math.pow(10,e);return""+(Math.round(n*a)/a).toFixed(e)};return u=(o?c(r,o):""+Math.round(r)).split("."),u[0].length>3&&(u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(u[1]||"").length<o&&(u[1]=u[1]||"",u[1]+=new Array(o-u[1].length+1).join("0")),u.join(s)}var v=function(a){if(s.stats_values=a,s.drawValueCallback!=e){var t=a[0].value;s.drawValueCallbackWithValue=s.drawValueCallback(t)}n.eventBus.publish("configuration-changed",{})},h=function(){return s.stats_values},g=function(n){if(n===s.stats_values)return!1;if(typeof n==typeof[])for(var e in n)if(n.hasOwnProperty(e)&&typeof n[e]!=typeof{})return!1;return!0},p=function(){return n.globalObjectName+"_setValues"},w=function(){if(l()){var e=p();if("undefined"!=typeof n.$window&&"undefined"!=typeof n.$window[e]){var a=n.$window[e];g(a)&&v(a)}}},b=function(n){return(""+n).match(/^\s*[0-9]+\s*$/)?d(n,0,""," "):n},A=function(e,a){return function(t){t.shadowColor="transparent",t.font=e.name.font,t.textAlign=e.name.align,t.fillStyle=e.name.color,t.fillText(a.name,e.name.x+r().xBase,e.name.y+r().yBase),t.font=e.value.font,t.textAlign=e.value.align,t.fillStyle=e.value.color;var o=a.value;try{o=b(a.value)}catch(i){n.debug(i)}t.fillText(o,e.value.x+r().xBase,e.value.y+r().yBase)}},m=function(){s.indexStatToShow+=i.length,s.indexStatToShow>=s.stats_values.length&&(s.indexStatToShow=0)},T=!1;n.eventBus.subscribe("draw-hideText",function(n){T=!0},11),n.eventBus.subscribe("draw-unHideText",function(n){T=!1},11);var C=function(n){if(!T){var e,a,t=s.indexStatToShow,r=h(),o=r.length;r.length>i.length&&(o=i.length);for(var u=0;o>u&&(t>=r.length&&(t=0),r[t]);u++)e=i[u],a=r[t],A(e,a)(n),t++}},y=function(n,a){return c++,w(),o(),s.drawValueCallbackWithValue!=e?(s.drawValueCallbackWithValue(n),void 0):(C(n),void 0)},I=function(e){n.eventBus.publish("draw-callback-publish-reconfiguration",{canvasCallbacks:[{cb:y,priority:15,name:"show_stats_draw"}]})};n.eventBus.subscribe("draw-callback-requested-reconfiguration",I,11);var x=n.eventBus.subscribe("drawing-change-text",m,10);a.draw=y,a.setBoxes=f,a.setValues=v}.call(i),function(){var n=this;n.IS_HISTATS_CANVAS||(n={});var a={main:"",source:e,loaded:!1};a.main="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAlCAMAAAC+qt3JAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADhUExURQAAAKItLZkgIKo1NZ4kJKYxMa41NaoxMaYtLaIoKJ4oKJokJJogIKQsLJghIaoiIqUpKaMsLKMrK5whIZkhIaUuLqMtLZkgIJggIJggIKMsLJggIJoiIpggIKQtLaMsLJkiIqQsLKQuLqozM6UvL6UvL6cuLqgrK6UuLpgiIqQtLZggIJoiIpoiIqUtLZ0hIZkjI6QtLZggIJkiIqkyMqgxMaozM6cwMKUuLqYvL6s0NKQtLaMsLKIrK6ApKaw1NZ4nJ50mJpskJJ8oKKEqKpwlJZojI5kiIpghIa02Nq43N0K0IcIAAAA0dFJOUwA/fz8/Pz8/Pz8/Pz+/Lw8fry8f78/vX+/fb7/vb79/D8/vD+/Pfy9vn99Pz2+fL6+Pj69skEw4AAACZElEQVRYw8XYiXLTMBAGYLdgEkjSgx5Q2gIt933Jrg/ALThxzPs/ECtbtqXVypLTFP6ZzmQSe77Z1VHZntfmme/7oy63IHfU8K+kK0Zwgz/usgG52+Ue5HaXyWTyydPz6uWLC0gAYYyFkASSQcqy/AN/Jf8MX/Gf4ArGr+R3xHEcQVLId8gPSJ7nPyG/IZeQK8h8Pv8FOfn8QWXvP4f7zXAp4OS68GKxeL8luTvnsRXO1gQvigetu30Q/Ut4v635cbQ6HA+Hi/2nYoCjXjhrXRmWCh4MF29q+KMON/INwcVeNcKRGa7lTLjNarLAuR3e5PAjO5xlWc/camCpYBv8kMO7/wFeTgE+TIVMwQlyV4TnGP4KczrFcDOtQwIOh8NXFHwEQ6zAPSUnJjgyw5cmeLnnfWlhrdeKnGid7tm4LPByCYM8s8EJck2ddoSLBn5rhaWsDz71Uh02yq27wsaF4E0MqyWHPQWvASanNVFyqHUar6YVYaLXIekqcOS2cWnwzAQLOVRdp05bd0wKvsBwRbef2c3CSA5VlxziwfATAZt7rcGBK2zeMWED2UgHlMzoTuNJ7QDDv8UemPW7ZMGW1STgY34QkOCu15TMXODcCeZnnzEeZLlk5uIOgUWnq9MePa8bmals7V4XPq6Ot2PcaySr6Vyt0+7wu/pgvUv2mpZRweTckic1uYyPmmenMwSbSw6IgslOy6tJO9y2D087h2SvdTqgCh48qafSc+qMLBnJQdBbsCvcPabyvD5QSqbkILAXbINPvp1ueSjb4k2GX2VkTn3BWAl6/aG9AOFvQCbTqYT+BQsNrt6lcM9TAAAAAElFTkSuQmCC";var t=function(e){var t=a.source=new Image;t.onload=function(){a.loaded=!0,n.eventBus.publish("background-image-loaded",a),n.eventBus.publish("configuration-changed",{})},t.src=a.main};n.eventBus.subscribe("FIRST-FRAME",t,5),n.image_base64_src=a}.call(i),function(){var n=this;n.IS_HISTATS_CANVAS||(n={});var e=n.counter={};e.ID="1",e.properties={w:120,h:37,hasShadow:!0};var a={animation_duration_inFrames:20,autoTriggerTextChange_onFrame:20,waitframesBetweenTwoAnimations:80},t=[{name:{x:8,y:15,align:"left",color:"#ffcc00",font:"11px Arial"},value:{x:112,y:32,align:"right",color:"#ffcc00",font:"11px Arial"}}];n.eventBus.publish("set-textbox-style",t),n.eventBus.publish("setCanvasProperties",e.properties),n.eventBus.publish("setAnimationProperties",a);var r={w:120,h:37,xBase:0,yBase:0,roundCornerX:12,roundCornerY:20,bgColor:"#9d2626"},o=function(e,a,t){var o=n.getXYCanvas(),i=r;e.beginPath(),e.moveTo(o.x+i.xBase+i.roundCornerX,o.y+i.yBase),e.lineTo(o.x+i.xBase+i.w-i.roundCornerX,o.y+i.yBase),e.quadraticCurveTo(o.x+i.xBase+i.w,o.y+i.yBase,o.x+i.xBase+i.w,o.y+i.yBase+i.roundCornerY),e.lineTo(o.x+i.xBase+i.w,o.y+i.yBase+i.h-i.roundCornerY),e.quadraticCurveTo(o.x+i.xBase+i.w,o.y+i.yBase+i.h,o.x+i.xBase+i.w-i.roundCornerX,o.y+i.xBase+i.h),e.lineTo(o.x+i.xBase+i.roundCornerX,o.y+i.yBase+i.h),e.quadraticCurveTo(o.x+i.xBase,o.y+i.yBase+i.h,o.x+i.xBase,o.y+i.yBase+i.h-i.roundCornerY),e.lineTo(o.x+i.xBase,o.y+i.yBase+i.roundCornerY),e.quadraticCurveTo(o.x+i.xBase,o.y+i.yBase,o.x+i.xBase+i.roundCornerX,o.y+i.yBase),e.fillStyle=i.bgColor,e.fill()},i=function(e,a,t){n.eventBus.publish("clear-canvas-rectangle",{}),o(e,a,t)},s=function(n,e){e.isInAnimationTransition&&e.frameCounter%3==0&&o(n)},u=function(e){n.eventBus.publish("draw-callback-publish-reconfiguration",{canvasCallbacks:[{cb:i,priority:10,name:"drawCounterRectangle"},{cb:s,priority:50,name:"executeAnimationTransition"}]})};return n.eventBus.subscribe("draw-callback-requested-reconfiguration",u,13),n}.call(i),l.AUTOSTART&&i.start()}catch(ln){}return i},w="base.js",b=window,A="_DEBUG_HISTATSCANVAS_RETURN_BUILDER";_value_RETURN_BUILDER=u(window[A])&&window[A]===!0,window[v()]=p,window["histats_canvascounters_"+w]=p}).call(this);